<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Sundew Algorithm – Energy‑constrained autonomic inference research dashboard: metrics, datasets, results, and downloads." />
  <meta name="theme-color" content="#2E86AB" />
  <title>Sundew Algorithm • Research Dashboard</title>
  <style>
    /* =====================
       Design System
       ===================== */
    :root {
      --bg: #0b1020;
      --surface: #0f152b;
      --muted: #96a0b5;
      --text: #e9ecf4;
      --primary: #2E86AB;
      --secondary: #A23B72;
      --accent: #F18F01;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --card: rgba(255,255,255,0.04);
      --card-border: rgba(255,255,255,0.08);
      --glass: rgba(255,255,255,0.06);
      --shadow-1: 0 10px 30px rgba(0,0,0,.25);
      --radius: 16px;
      --radius-sm: 10px;
      --radius-lg: 24px;
      --transition: 240ms cubic-bezier(.2,.8,.2,1);
      /* Hero gradient tuned to your screenshot (periwinkle→soft blue) */
      --grad-hero: linear-gradient(135deg, #6a79f0 0%, #6f81ff 50%, #7f8cff 100%);
    }
    .theme-light {
      --bg: #f4f7fb; --surface:#fff; --text:#101428; --muted:#55607a;
      --card: #fff; --card-border:#e7eaf0; --glass: rgba(255,255,255,.7);
      --shadow-1: 0 10px 24px rgba(28,24,46,.08);
      /* Lighter variant of the new hero gradient for light mode */
      --grad-hero: linear-gradient(135deg, #8592ff 0%, #9aa7ff 60%, #b2bdff 100%);
    }

    * { box-sizing:border-box }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text); background: var(--bg);
      line-height: 1.5; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
    }

    /* ===== Layout ===== */
    .container { width: min(1200px, 92vw); margin-inline: auto; }
    .section { padding: 56px 0; }

    /* ===== Skip link ===== */
    .skip-link { position:absolute; left:-1000px; top:-1000px; }
    .skip-link:focus { left: 16px; top: 16px; background:#111; color:#fff; padding:8px 12px; border-radius:8px; z-index:9999; }

    /* ===== Navbar ===== */
    .navbar { position: sticky; top: 0; z-index: 50; backdrop-filter: blur(12px); background: color-mix(in oklab, var(--surface), transparent 40%); border-bottom:1px solid var(--card-border); }
    .nav-wrap { display:flex; align-items:center; justify-content:space-between; gap: 16px; padding-block: 12px; }
    .brand { display:flex; align-items:center; gap:10px; font-weight: 800; letter-spacing:.2px; }
    .brand .logo { width: 28px; height: 28px; border-radius:8px; background: linear-gradient(135deg, var(--primary), var(--secondary)); box-shadow: var(--shadow-1); }
    .nav { display:flex; flex-wrap:wrap; gap: 6px; }
    .nav a { color: var(--muted); text-decoration:none; padding:8px 12px; border-radius: 10px; transition: var(--transition); font-weight: 600; }
    .nav a:hover, .nav a[aria-current="page"] { color: var(--text); background: var(--card); }

    /* ===== Hero ===== */
    .hero { background: var(--grad-hero); position: relative; overflow:hidden; }
    .hero .container { padding-block: 72px; text-align: center; }
    .eyebrow { display:inline-flex; align-items:center; gap:8px; font-size:.85rem; color: var(--muted); background: var(--glass); border: 1px solid var(--card-border); padding:6px 10px; border-radius: 999px; }
    .title { font-size: clamp(2rem, 6vw, 3.5rem); line-height:1.05; letter-spacing:-.02em; margin: 14px 0 10px; font-weight: 900; }
    .title-gradient { background: none; -webkit-background-clip: initial; background-clip: initial; color: #ffffff; text-shadow: 0 2px 0 rgba(0,0,0,.18), 0 10px 24px rgba(0,0,0,.22); }
    .subtitle { color: rgba(255,255,255,.92); font-size: clamp(1rem, 2.6vw, 1.2rem); max-width: 70ch; text-shadow: 0 1px 0 rgba(0,0,0,.18); margin-inline: auto; }
    .badge-row { display:flex; flex-wrap:wrap; gap:10px; margin-top: 20px; }
    .badge { background: var(--glass); border:1px solid var(--card-border); padding: 8px 12px; border-radius: 999px; font-weight: 700; color: var(--text); }
    .cta { margin-top: 22px; display:flex; gap: 12px; flex-wrap:wrap }
    .btn { appearance:none; border:none; cursor:pointer; font-weight: 800; letter-spacing:.2px; padding: 12px 16px; border-radius: 12px; transition: var(--transition); }
    .btn-primary { background: linear-gradient(135deg, var(--primary), #46a6cc); color: white; box-shadow: var(--shadow-1); }
    .btn-primary:hover { transform: translateY(-2px) scale(1.01); }
    .btn-ghost { background: var(--card); color: var(--text); border:1px solid var(--card-border); }

    /* ===== Cards & grids ===== */
    .grid { display:grid; gap:20px; grid-template-columns: repeat(12, 1fr); }
    .card { background: var(--card); border: 1px solid var(--card-border); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow-1); }
    .card h3 { margin:0 0 10px; font-size: 1.15rem; }
    .span-4 { grid-column: span 4 }
    .span-6 { grid-column: span 6 }
    .span-8 { grid-column: span 8 }
    .span-12 { grid-column: 1 / -1 }
    @media (max-width: 900px){ .span-4, .span-6, .span-8 { grid-column: 1 / -1 } }

    /* ===== Stats ===== */
    .stats { display:grid; gap:14px; grid-template-columns: repeat(4,1fr); }
    @media (max-width: 900px){ .stats { grid-template-columns: 1fr 1fr } }
    .stat { background: linear-gradient(180deg, color-mix(in oklab, var(--card), transparent 10%), transparent); border:1px solid var(--card-border); border-radius: 14px; padding:16px; }
    .stat .value { font-size: clamp(1.6rem, 4vw, 2.4rem); font-weight: 900 }
    .stat .label { color: var(--muted); font-weight: 600 }
    .progress { height: 8px; border-radius: 999px; background: color-mix(in oklab, var(--text), transparent 90%); overflow:hidden; margin-top:8px }
    .progress > span { display:block; height:100%; width:0; background: linear-gradient(90deg, var(--success), var(--accent)); transition: width 1200ms ease }

    /* ===== Table ===== */
    table { width:100%; border-collapse: collapse; }
    thead th { text-align:left; font-size:.9rem; color:var(--muted); border-bottom:1px solid var(--card-border); padding:10px 10px; }
    tbody td { padding:12px 10px; border-bottom:1px dashed var(--card-border); }
    tbody tr:hover { background: color-mix(in oklab, var(--card), transparent 30%); }

    /* ===== Gallery ===== */
    .gallery { display:grid; gap:16px; grid-template-columns: repeat(12, 1fr); }
    .tile { position:relative; overflow:hidden; border-radius: 14px; border:1px solid var(--card-border); background: #0a0f22; min-height: 180px; } .tile.broken::before{content:'Image not found';position:absolute;inset:0;display:grid;place-items:center;color:#fff;background:linear-gradient(180deg,#0b1020,#131a36);} .tile.broken .overlay{background:linear-gradient(180deg,rgba(0,0,0,.2),rgba(0,0,0,.7));} .tile img { width:100%; height:100%; object-fit:cover; opacity:1; transition: opacity var(--transition) }
    .tile img { width:100%; height:100%; object-fit:cover; opacity:1; transition: opacity var(--transition) }
    .tile.loaded img { opacity:1 }
    .tile .overlay { position:absolute; inset:auto 0 0 0; padding:14px; background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.6)); color:#fff }
    .col-4 { grid-column: span 4 }
    .col-6 { grid-column: span 6 }
    .col-12 { grid-column: 1 / -1 }
    @media (max-width: 900px){ .col-4, .col-6 { grid-column: 1 / -1 } }

    /* ===== Chips ===== */
    .chip { display:inline-flex; align-items:center; gap:8px; background: var(--card); border:1px solid var(--card-border); color: var(--text); padding:6px 10px; border-radius: 999px; font-weight:700 }

    /* ===== Footer ===== */
    .footer { border-top:1px solid var(--card-border); background: color-mix(in oklab, var(--surface), transparent 30%); }

    /* ===== Motion safety ===== */
    @media (prefers-reduced-motion: reduce){
      * { animation: none !important; transition: none !important }
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="container nav-wrap">
      <div class="brand" aria-label="Sundew brand">
        <span class="logo" aria-hidden="true"></span>
        <span>Sundew Research</span>
      </div>
      <nav class="nav" aria-label="Primary">
        <a href="#overview">Overview</a>
        <a href="#kpis">KPIs</a>
        <a href="#datasets">Datasets</a>
        <a href="#results">Results</a>
        <a href="#visuals">Visuals</a>
        <a href="#algos">Algorithms</a>
        <a href="#downloads">Downloads</a>
        <button id="modeToggle" class="btn btn-ghost" aria-pressed="false" title="Toggle theme">🌓 Theme</button>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero" id="overview">
    <div class="container">
      <span class="eyebrow">Energy‑Constrained Autonomic Inference</span>
      <h1 class="title title-gradient">Decide <em>when</em> to think.<br/>Maximize utility per joule.</h1>
      <p class="subtitle">Sundew is an energy‑aware gating controller for real‑time AI. It allocates compute only when the expected utility beats the marginal cost—at millisecond latency.</p>
      <div class="badge-row" role="list">
        <span class="badge" role="listitem">25k+ samples</span>
        <span class="badge" role="listitem">6 configurations</span>
        <span class="badge" role="listitem">5 domains</span>
        <span class="badge" role="listitem">Research‑grade</span>
        <span class="badge" role="listitem">Energy‑efficient</span>
      </div>
      <div class="cta">
        <a class="btn btn-primary" href="#downloads">Get the SDK & Data</a>
        <a class="btn btn-ghost" href="#results">View Benchmarks</a>
      </div>
    </div>
  </section>

  <main id="main" class="container">
    <!-- KPIs -->
    <section id="kpis" class="section">
      <div class="grid">
        <article class="card span-12">
          <h3>Executive Summary</h3>
          <p style="color:var(--muted);max-width:70ch">World‑class selective activation demonstrated across five real‑world domains with up to <strong>99.7% energy efficiency</strong> and <strong>11k+ samples/sec</strong> throughput.</p>
          <div class="stats" style="margin-top:14px">
            <div class="stat" aria-live="polite">
              <div class="value" data-count="89.4">0</div>
              <div class="label">Avg Energy Efficiency (%)</div>
              <div class="progress" aria-hidden="true"><span style="--to:89.4%"></span></div>
            </div>
            <div class="stat" aria-live="polite">
              <div class="value" data-count="8969">0</div>
              <div class="label">Avg Throughput / sec</div>
              <div class="progress" aria-hidden="true"><span style="--to:90%"></span></div>
            </div>
            <div class="stat" aria-live="polite">
              <div class="value" data-count="0.336">0</div>
              <div class="label">Avg F1 Score</div>
              <div class="progress" aria-hidden="true"><span style="--to:34%"></span></div>
            </div>
            <div class="stat" aria-live="polite">
              <div class="value" data-count="7.4">0</div>
              <div class="label">Research Quality Score</div>
              <div class="progress" aria-hidden="true"><span style="--to:74%"></span></div>
            </div>
          </div>
        </article>

        <article class="card span-6">
          <h3>🚀 Performance Highlights</h3>
          <ul style="margin:0; padding-left: 1.2rem">
            <li>Energy Efficiency: <strong>up to 99.7%</strong></li>
            <li>Max Throughput: <strong>11,465 samples/sec</strong></li>
            <li>Research Quality: <strong>8.1+</strong></li>
          </ul>
          <div class="progress" style="margin-top:12px"><span style="--to:99.7%"></span></div>
        </article>

        <article class="card span-6">
          <h3>🎯 Algorithm Innovations</h3>
          <div style="display:grid;gap:8px">
            <span class="chip">Mutual‑information threshold adaptation</span>
            <span class="chip">Vectorized batch processing (2–3×)</span>
            <span class="chip">AutoML HPO integration</span>
            <span class="chip">Lyapunov‑backed stability</span>
            <span class="chip">Temporal‑attention significance models</span>
            <span class="chip">MPC threshold scheduling</span>
          </div>
        </article>
      </div>
    </section>

    <!-- DATASETS -->
    <section id="datasets" class="section">
      <div class="grid">
        <article class="card span-12">
          <h3>📚 Datasets</h3>
          <p style="color:var(--muted)">Popular and realistic datasets spanning multiple domains.</p>
          <div class="grid" style="margin-top:10px">
            <div class="card span-6" style="border-left:4px solid var(--success)">
              <h4>🏥 UCI Heart Disease</h4>
              <p>Cardiovascular risk with clinical features.</p>
              <div style="display:flex;justify-content:space-between;align-items:center;color:var(--muted)">
                <span><strong>1,000</strong> samples · Medical</span>
                <a class="btn btn-ghost" href="data/raw/uci_heart_disease.csv" download>Download CSV</a>
              </div>
            </div>
            <div class="card span-6" style="border-left:4px solid var(--success)">
              <h4>🔬 Breast Cancer Wisconsin</h4>
              <p>Tumor characteristics (sklearn format).</p>
              <div style="display:flex;justify-content:space-between;align-items:center;color:var(--muted)">
                <span><strong>569</strong> samples · Medical</span>
                <a class="btn btn-ghost" href="data/raw/breast_cancer_wisconsin.csv" download>Download CSV</a>
              </div>
            </div>
            <div class="card span-6" style="border-left:4px solid var(--accent)">
              <h4>💰 Financial Time Series</h4>
              <p>Synthetic market data with volatility & anomalies.</p>
              <div style="display:flex;justify-content:space-between;align-items:center;color:var(--muted)">
                <span><strong>2,000</strong> samples · Finance</span>
                <a class="btn btn-ghost" href="data/raw/financial_time_series.csv" download>Download CSV</a>
              </div>
            </div>
            <div class="card span-6" style="border-left:4px solid var(--accent)">
              <h4>🌡️ IoT Sensors</h4>
              <p>Temperature, humidity, pressure, light, motion; anomaly injection.</p>
              <div style="display:flex;justify-content:space-between;align-items:center;color:var(--muted)">
                <span><strong>1,500</strong> samples · IoT</span>
                <a class="btn btn-ghost" href="data/raw/iot_sensor_monitoring.csv" download>Download CSV</a>
              </div>
            </div>
            <div class="card span-6" style="border-left:4px solid var(--secondary)">
              <h4>🔒 Network Security</h4>
              <p>Packet/connection patterns & IDS anomalies.</p>
              <div style="display:flex;justify-content:space-between;align-items:center;color:var(--muted)">
                <span><strong>1,200</strong> samples · Cybersecurity</span>
                <a class="btn btn-ghost" href="data/raw/network_security.csv" download>Download CSV</a>
              </div>
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- RESULTS -->
    <section id="results" class="section">
      <div class="grid">
        <article class="card span-8">
          <h3>📈 Results Summary</h3>
          <table aria-label="Performance results">
            <thead>
              <tr>
                <th>Configuration</th>
                <th>Energy Efficiency</th>
                <th>Throughput</th>
                <th>F1 Score</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Baseline Linear</td><td>89.0%</td><td>11,236/sec</td><td>0.329</td></tr>
              <tr><td>Enhanced Neural</td><td>99.7%</td><td>5,689/sec</td><td>0.039</td></tr>
              <tr><td>Edge Optimized</td><td>91.3%</td><td>8,565/sec</td><td>0.348</td></tr>
              <tr><td>Real‑time Optimized</td><td>89.2%</td><td>10,527/sec</td><td>0.339</td></tr>
            </tbody>
          </table>
        </article>
        <article class="card span-4">
          <h3>🏆 Research Quality</h3>
          <div style="display:grid;gap:10px">
            <div class="card" style="padding:12px;">
              <div style="display:flex;justify-content:space-between"><strong>Enhanced Neural</strong><strong style="color:var(--success)">8.08 / 10</strong></div>
            </div>
            <div class="card" style="padding:12px;">
              <div style="display:flex;justify-content:space-between"><strong>Edge Optimized</strong><strong style="color:var(--success)">7.62 / 10</strong></div>
            </div>
            <div class="card" style="padding:12px;">
              <div style="display:flex;justify-content:space-between"><strong>Real‑time Optimized</strong><strong style="color:var(--warning)">7.22 / 10</strong></div>
            </div>
            <div class="card" style="padding:12px;">
              <div style="display:flex;justify-content:space-between"><strong>Baseline Linear</strong><strong style="color:var(--primary)">6.93 / 10</strong></div>
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- VISUALS -->
    <section id="visuals" class="section">
      <article class="card">
        <h3>📊 Visualizations</h3>
        <p style="color:var(--muted)">Drop your plots into the paths below; tiles will auto‑fade when the images load.</p>
        <div class="gallery" style="margin-top:12px">
          <div class="tile col-6"><img src="data/Visualizations/research_summary_infographic.png" alt="Research summary infographic" loading="eager" onerror="this.style.display='none'; this.parentElement.classList.add('broken')"><div class="overlay"><strong>Summary</strong><div>Key findings & breakthroughs</div></div></div>
          <div class="tile col-6"><img src="data/Visualizations/performance_overview.png" alt="Performance overview charts" loading="eager" onerror="this.style.display='none'; this.parentElement.classList.add('broken')"><div class="overlay"><strong>Performance</strong><div>Multi‑dimensional metrics</div></div></div>
          <div class="tile col-4"><img src="data/Visualizations/energy_analysis.png" alt="Energy consumption analysis" loading="eager" onerror="this.style.display='none'; this.parentElement.classList.add('broken')"><div class="overlay"><strong>Energy</strong><div>Efficiency & consumption</div></div></div>
          <div class="tile col-4"><img src="data/Visualizations/algorithm_comparison.png" alt="Algorithm comparison" loading="eager" onerror="this.style.display='none'; this.parentElement.classList.add('broken')"><div class="overlay"><strong>Comparison</strong><div>Head‑to‑head configurations</div></div></div>
          <div class="tile col-4"><img src="data/Visualizations/dataset_analysis.png" alt="Dataset analysis" loading="eager" onerror="this.style.display='none'; this.parentElement.classList.add('broken')"><div class="overlay"><strong>Datasets</strong><div>Domain breakdowns</div></div></div>
        </div>
      </article>
    </section>

    <!-- ALGORITHMS -->
    <section id="algos" class="section">
      <div class="grid">
        <article class="card span-4"><h3>⚡ Baseline Linear</h3><p><strong>Focus:</strong> Speed & Energy</p><ul><li>Linear significance</li><li>Temp‑based gating</li><li>PI controller</li><li>Simple energy model</li></ul><div style="margin-top:10px" class="chip">HIGH SPEED</div></article>
        <article class="card span-4"><h3>🧠 Enhanced Neural</h3><p><strong>Focus:</strong> Intelligence</p><ul><li>Neural significance</li><li>Adaptive gating</li><li>Advanced PI</li><li>Realistic energy</li></ul><div style="margin-top:10px" class="chip">HIGH ACCURACY</div></article>
        <article class="card span-4"><h3>🎯 Edge Optimized</h3><p><strong>Focus:</strong> Resource</p><ul><li>Info‑theoretic thresholds</li><li>Batch optimizations</li><li>Energy‑efficient</li><li>Edge‑ready</li></ul><div style="margin-top:10px" class="chip">EDGE READY</div></article>
        <article class="card span-4"><h3>☁️ Cloud Optimized</h3><p><strong>Focus:</strong> Features</p><ul><li>Full neural stack</li><li>AutoML</li><li>Theory & proofs</li><li>High throughput</li></ul><div style="margin-top:10px" class="chip">RESEARCH GRADE</div></article>
        <article class="card span-4"><h3>⚡ Real‑time Optimized</h3><p><strong>Focus:</strong> Latency</p><ul><li>Batch engine</li><li>Speed optimized</li><li>RT constraints</li><li>Streaming ready</li></ul><div style="margin-top:10px" class="chip">REAL‑TIME</div></article>
        <article class="card span-4"><h3>🔬 Advanced MPC</h3><p><strong>Focus:</strong> Dynamic Control</p><ul><li>MPC</li><li>Dynamic optimization</li><li>Neural + control</li><li>Prototype</li></ul><div style="margin-top:10px" class="chip" style="background:var(--danger)">EXPERIMENTAL</div></article>
      </div>
    </section>

    <!-- DOWNLOADS -->
    <section id="downloads" class="section">
      <article class="card">
        <h3>📥 Downloads</h3>
        <div class="grid" style="margin-top:8px">
          <div class="card span-4" style="background:transparent">
            <h4>📊 Raw Datasets</h4>
            <p style="color:var(--muted)">Original CSVs</p>
            <a class="btn btn-primary" href="data/raw/">Browse Raw Data</a>
          </div>
          <div class="card span-4" style="background:transparent">
            <h4>📈 Results</h4>
            <p style="color:var(--muted)">Analysis & metrics</p>
            <a class="btn btn-ghost" href="data/results/">View Results</a>
          </div>
          <div class="card span-4" style="background:transparent">
            <h4>🎨 Visualizations</h4>
            <p style="color:var(--muted)">High‑quality plots</p>
            <a class="btn" style="background:var(--accent);color:#fff" href="Visualizations/">View Plots</a>
          </div>
        </div>
        <div class="card" style="margin-top:14px">
          <h4>Key Files</h4>
          <ul>
            <li><a href="data/results/comprehensive_summary.csv" download>Comprehensive Results (CSV)</a></li>
            <li><a href="data/results/detailed_results.csv" download>Detailed Sample Results (CSV)</a></li>
            <li><a href="data/results/dataset_information.csv" download>Dataset Information (CSV)</a></li>
            <li><a href="data/Visualizations/research_summary_infographic.png" download>Research Summary Infographic (PNG)</a></li>
            <li><a href="assets/Whitepaper.md" download>Technical Whitepaper (MD)</a></li>
            <li><a href="assets/README.md" download>Implementation Guide (MD)</a></li>
          </ul>
        </div>
      </article>
    </section>
  </main>

  <footer class="footer section">
    <div class="container" style="text-align:center">
      <h3 style="margin:0 0 8px">Sundew Algorithm Research Project</h3>
      <p style="color:var(--muted);max-width:68ch;margin-inline:auto">Bio‑inspired selective activation for energy‑efficient edge AI. Multi‑domain validation. Production‑ready.</p>
      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px;flex-wrap:wrap">
        <span class="chip">World‑Class Quality</span>
        <span class="chip">Multi‑Domain Validated</span>
      </div>
      <button id="toTop" class="btn btn-ghost" style="margin-top:16px">↑ Back to top</button>
    </div>
  </footer>

  <script>
    // Active link highlighting on scroll
    const sections = [...document.querySelectorAll('main section, .hero')];
    const navLinks = [...document.querySelectorAll('.nav a[href^="#"]')];
    const map = new Map(sections.map(s => [s.id || 'overview', s]));
    const io = new IntersectionObserver((entries)=>{
      const visible = entries.filter(e=>e.isIntersecting).sort((a,b)=>b.intersectionRatio - a.intersectionRatio)[0];
      if(!visible) return;
      const id = visible.target.id || 'overview';
      navLinks.forEach(a=>a.removeAttribute('aria-current'));
      const match = document.querySelector('.nav a[href="#'+id+'"]');
      if(match) match.setAttribute('aria-current','page');
    }, { threshold:[0.4, 0.6], rootMargin:'-20% 0px -60% 0px' });
    sections.forEach(s=>io.observe(s));

    // Theme toggle
    const modeToggle = document.getElementById('modeToggle');
    const setTheme = (t)=>{ document.body.classList.toggle('theme-light', t==='light'); localStorage.setItem('sundew-theme', t) }
    const initTheme = localStorage.getItem('sundew-theme') || (matchMedia('(prefers-color-scheme: light)').matches ? 'light':'dark');
    setTheme(initTheme);
    modeToggle.setAttribute('aria-pressed', initTheme==='light');
    modeToggle.addEventListener('click',()=>{
      const to = document.body.classList.contains('theme-light') ? 'dark' : 'light';
      setTheme(to); modeToggle.setAttribute('aria-pressed', to==='light');
    });

    // Smooth scroll for internal links
    document.querySelectorAll('a[href^="#"]').forEach(a=>a.addEventListener('click', e=>{
      const id = a.getAttribute('href'); if(!id || id==='#') return;
      e.preventDefault(); document.querySelector(id)?.scrollIntoView({behavior:'smooth'});
    }));

    // Back to top
    document.getElementById('toTop').addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

    // Progress bars + counters
    const counters = document.querySelectorAll('[data-count]');
    const bars = document.querySelectorAll('.progress > span');
    const animate = (el, to, dur=900)=>{
      const t0 = performance.now();
      const from = 0; const isFloat = String(to).includes('.')
      const step = (t)=>{
        const p = Math.min(1, (t - t0)/dur);
        const val = from + (to - from)*p;
        el.textContent = isFloat ? val.toFixed(3) : Math.round(val);
        if(p<1) requestAnimationFrame(step);
      }; requestAnimationFrame(step);
    };
    const kpiIO = new IntersectionObserver((ents)=>{
      ents.forEach(en=>{
        if(en.isIntersecting){
          counters.forEach(c=> animate(c, Number(c.dataset.count)));
          bars.forEach(b=> b.style.width = getComputedStyle(b).getPropertyValue('--to') || '0%');
          kpiIO.disconnect();
        }
      })
    }, { threshold:.35 });
    kpiIO.observe(document.getElementById('kpis'));

    // Image fade-in when loaded
    document.querySelectorAll('.tile img').forEach(img=>{
      img.addEventListener('load', ()=> img.parentElement.classList.add('loaded'));
    });
      // --- GH Pages base-path fixer (works for user or project sites) ---
    (function(){
      const parts = location.pathname.split('/').filter(Boolean);
      const base = parts.length > 0 ? ('/' + parts[0] + '/') : '/';
      document.querySelectorAll('img[src^="/"], a[href^="/"]').forEach(el => {
        const attr = el.tagName === 'IMG' ? 'src' : 'href';
        const url = el.getAttribute(attr);
        if (!url) return;
        el.setAttribute(attr, base + url.replace(/^\//, ''));
      });
    })();
  </script>
</body>
</html>
